<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <title>XML DOM Examples</title>
    </head>
    <body>
        <h2>XML DOM Examples using Bookstore XML</h2>
        <div id="XMLDOM"></div>

        <script>
            var text = `
                    <?xml version="1.0" encoding="UTF-8"?>
                    <bookstore>
                    <book category="Entertainment">
                        <title lang="En">Harry Potter</title>
                        <Author>J.K. Rowling</Author>
                        <Year>2009</Year>
                        <Price>$45.99</Price>
                    </book>

                    <book category="Fiction">
                        <title lang="En">Avengers</title>
                        <Author>Warner Bros</Author>
                        <Year>2010</Year>
                        <Price>$32.89</Price>
                    </book>

                    <book category="Mysery">
                        <title lang="Sp">The Great Gatsby</title>
                        <Author>F Scott Fitzgerald</Author>
                        <Year>1920</Year>
                        <Price>$1.99</Price>
                    </book>

                    <book category="Historical">
                        <title lang="Fr">Things Fall Apart</title>
                        <Author>Chinua Achebe</Author>
                        <Year>1958</Year>
                        <Price>$12.99</Price>
                    </book>

                    <book category="Tragedy">
                        <title lang="Es">Hamlet</title>
                        <Author>William Shakespeare</Author>
                        <Year>1601</Year>
                        <Price>$24.99</Price>
                    </book>
                    </bookstore>`;

            // Parse the XML (trim leading/trailing whitespace so the XML prolog is at the start)
            var parser = new DOMParser();
            var xmlDoc = parser.parseFromString(text.trim(), "text/xml");
            var txt = "";

            // ========== 4. Remove an element node ==========
            var firstBook = xmlDoc.getElementsByTagName("book")[0];
            firstBook.parentNode.removeChild(firstBook);

            // ========== 5. Remove a text node ==========
            var t = xmlDoc.getElementsByTagName("title")[0];
            if (t && t.childNodes[0]) {
            t.removeChild(t.childNodes[0]);
            }

            // ========== 6. Remove an attribute ==========
            var b = xmlDoc.getElementsByTagName("book")[0];
            b.removeAttribute("category");

            // ========== 7. Replace an element ==========
            var newBook = xmlDoc.createElement("book");
            var newTitle = xmlDoc.createElement("title");
            var newText = xmlDoc.createTextNode("A Notebook");
            newTitle.appendChild(newText);
            newBook.appendChild(newTitle);
            var oldBook = xmlDoc.getElementsByTagName("book")[1];
            xmlDoc.documentElement.replaceChild(newBook, oldBook);

            // ========== 8. Replace data in text node ==========
            var titleNode = xmlDoc.getElementsByTagName("title")[0].childNodes[0];
            if (titleNode) titleNode.replaceData(0, 5, "Fantastic Beasts");

            // ========== 9. Create a new attribute ==========
            var newAtt = xmlDoc.createAttribute("Edition");
            newAtt.nodeValue = "First";
            var titleElem = xmlDoc.getElementsByTagName("title")[0];
            titleElem.setAttributeNode(newAtt);

            // ========== 10. Create a text node ==========
            var newEl = xmlDoc.createElement("Edition");
            var newTxt = xmlDoc.createTextNode("Second");
            newEl.appendChild(newTxt);
            var book0 = xmlDoc.getElementsByTagName("book")[0];
            book0.appendChild(newEl);

            // ========== 11. Add a node (appendChild) ==========
            var newNode = xmlDoc.createElement("Publisher");
            book0.appendChild(newNode);

            // ========== 12. Insert a node (insertBefore) ==========
            var insertNode = xmlDoc.createElement("Discount");
            var refNode = book0.getElementsByTagName("Year")[0];
            book0.insertBefore(insertNode, refNode);

            // ========== 14. Clone Node ==========
            var clone = book0.cloneNode(true);
            xmlDoc.documentElement.appendChild(clone);

            // Display all <title> values
            var titles = xmlDoc.getElementsByTagName("title");
            for (var i = 0; i < titles.length; i++) {
                // Use textContent which is robust if a text node was removed earlier
                var t = titles[i].textContent || "";
                if (t.trim()) txt += t.trim() + "<br>";
            }
            document.getElementById("XMLDOM").innerHTML = txt;
        </script>
    </body>
</html>
